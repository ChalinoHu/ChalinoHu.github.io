---
title: 09 区间合并
date: 2022-05-27 21:39:13
tags: 算法基础
---



# 区间合并

多个有交集的区间可合并为第一个区间，区间合并是一种比较快的合并方式。在这里多个区间有端点相同则认为这两个区间也是可以合并的。

区间合并的步骤：

1、先将各个区间进行排序，这样对于目前维护的区间，后续处理的区间都不会包含该区间。

2、下一个处理区间的左端点是否在目前维护区间的右端点右边？目前区间不能和接下来的区间进行合并：需要和接下来的区间进行合并。

代码模板：

```C++
// 将所有存在交集的区间合并
void merge(vector<PII> &segs)
{
    vector<PII> res;

    sort(segs.begin(), segs.end());

    int st = -2e9, ed = -2e9;
    for (auto seg : segs)
        if (ed < seg.first)
        {
            if (st != -2e9) res.push_back({st, ed});
            st = seg.first, ed = seg.second;
        }
        else ed = max(ed, seg.second);

    if (st != -2e9) res.push_back({st, ed});

    segs = res;
}
```

### 例题：

给定 n 个区间 [li,ri]，要求合并所有有交集的区间。

注意如果在端点处相交，也算有交集。

输出合并完成后的区间个数。

例如：[1,3][1,3] 和 [2,6][2,6] 可以合并为一个区间 [1,6][1,6]。

#### 输入格式

第一行包含整数 n。

接下来 n 行，每行包含两个整数 l 和 r。

#### 输出格式

共一行，包含一个整数，表示合并区间完成后的区间个数。

#### 数据范围

1≤n≤100000,
−1e9≤ li ≤ ri ≤1e9

#### 输入样例：

```
5
1 2
2 4
5 6
7 8
7 9
```

#### 输出样例：

```
3
```

```c++
#include <iostream>
#include <vector>
#include <algorithm>

using namespace std;

const int N = 100010;
int n;

typedef pair<int, int> PII;

vector<PII> megs;

// 区间和并
void merge(vector<PII> &megs){
    vector<PII> res;
    int st = -2e9, ed = -2e9;   //目前维护区间
    
    sort(megs.begin(), megs.end()); // 排序，先按照左端点进行排序，再按照右端点进行排序。
    
    for(auto meg: megs){
        
        int l = meg.first, r = meg.second;  // 接下来处理区间的左端点和右端点
        
        if (l > ed){    //目前维护的区间不需要进行合并
            if (st != -2e9) res.push_back({l, r});    // 判断是否是最开始最开始维护区间的边界
            st = l, ed = r;
        }
        else{   // 需要进行合并的部分
            ed = max(ed, r);
        }
    }
    if (st != -2e9) res.push_back({st, ed});
    megs = res;
}


int main(){
    
    cin >> n;
    
    for(int i = 0; i < n; i++){
        int l ,r;
        cin >> l >> r;
        megs.push_back({l, r});
    }
    
    merge(megs);
    
    cout << megs.size() << endl;
    
    return 0;
}
```

