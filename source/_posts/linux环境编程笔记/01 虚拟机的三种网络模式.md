---
title: 01 虚拟机的三种网络模式
date: 2022-05-27 21:02:46
tags: linux环境编程
---



vmware有三种网络设置模式，分别是Bridged(桥接),NAT(网络地址转换)，Host-only(私有网络共享主机)



### 1.Bridge(桥接)——类似处于同一局域网的两台主机

桥接模式默认使用的是：VMnet0

桥接模式就是把主机网卡和虚拟机虚拟的网卡利用虚拟网桥进行通信。在桥接的作用下，**类似于把物理主机虚拟为一个交换机，所有桥接设置的虚拟机连接到这个交换机的一个接口上**，物理主机也同样插在这个交换机当中，所以所有桥接下的网卡与网卡都是交换模式的，相互可以访问而不干扰。在桥接模式下，虚拟机ip地址需要与主机在同一个网段，如果需要联网，则网关与DNS需要与主机网卡一致。

 这种联网方式最简单，在局域网内，你的主机时怎么联网的，你再虚拟机里就怎么联网。把虚拟机看成局域网内的另一台电脑就可以了。

但是这种方式不太适合ip资源紧张的情况，在ip紧张的情况下，可以使用NAT模式。

### 2.NAT(网络地址转换)——不同局域网中的两台主机

NAT模式默认使用的是：VMnet8

NAT就是Network address translate 的简称。NAT技术应用在internet 网关和路由器上，比如192.168.0.123这个地址要访问internet，它的数据包就要通过一个网关或者路由器，而网关或者路由器拥有一个能访问internet的ip地址，这样的网关和路由器就要在**收发数据包时，对数据包的IP协议层数据进行更改（即 NAT），以使私有网段的主机能够顺利访问internet**。此技术解决了IP地址稀缺的问题。同样的私有IP可以网关NAT 上网。 

VMWare的NAT上网也是同样的道理，它在主机和虚拟机之间用软件伪造出一块网卡，这块网卡和虚拟机的ip处于一个地址段。同时，在这块网卡和主机的网络接口之间进行NAT。虚拟机发出的每一块数据包都会经过虚拟网卡，然后NAT，然后由主机的接口发出。 

在NAT模式中，主机网卡直接与虚拟NAT设备相连，然后虚拟NAT设备与虚拟DHCP服务器一起连接在虚拟交换机VMnet8上，这样就实现了虚拟机联网。那么我们会觉得很奇怪，为什么需要虚拟网卡VMware Network Adapter VMnet8呢？原来我们的VMware Network Adapter VMnet8虚拟网卡主要是为了实现主机与虚拟机之间的通信。

### 3.Host-only(仅主机模式)

Host-Only模式其实就是NAT模式去除了虚拟NAT设备，然后使用VMware Network Adapter VMnet1虚拟网卡连接VMnet1虚拟交换机来与虚拟机通信的，Host-Only模式将虚拟机与外网隔开，使得虚拟机成为一个独立的系统，只与主机相互通讯。如果要使得虚拟机能联网，我们可以将主机网卡共享给VMware Network Adapter VMnet1网卡，从而达到虚拟机联网的目的。



另外一个说法：

-host-only：看网上说也叫隔离模式，个人理解就类似于Vmware的仅主机模式，意思就是将所有的虚拟机组成一个局域网，不能和外界通信，不能访问Internet，其他主机也不能访问虚拟主机，安全性高。

 -NAT方式： 用户网络（User Networking）：让虚拟机访问主机、互联网或本地网络上的资源的简单方法，但是不能从网络或其他的客户机访问客户机，性能上也需要大的调整。

 -Bridge方式：虚拟网桥（Virtual Bridge）：这网络模式下客户机与宿主机处于同一网络环境，类似于一台真实的宿主机，直接访问网络资源，设置好后客户机与互联网，客户机与主机之间的通信都很容易。

